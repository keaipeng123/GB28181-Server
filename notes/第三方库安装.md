# 第三方库安装

## 1. 库预览

### 1.1 gflags

`gflags` 是 Google 开源的**命令行参数（flags）解析库**，主要用于 C++ 项目（也有其它语言的绑定/移植版本）。

- 核心用途：把程序启动参数（如 `--port=5060`、`--log_dir=/tmp/logs`）映射为程序内的全局/静态配置变量。
- 特点：
	- 支持多类型 flag（bool/int32/int64/double/string 等）
	- 自动生成 `--help` / `--helpshort` 等帮助信息
	- 统一管理默认值、参数说明、校验与读取
- 常见场景：服务端进程的端口、配置文件路径、开关选项、调试参数等。

### 1.2 glog

`glog` 是 Google 开源的 **C++ 日志库（Google Logging）**，用于输出结构化日志、控制日志级别、写入文件等。

- 核心用途：提供统一的日志 API，把运行过程中的信息按级别输出到终端/文件，便于排错与运维。
- 典型能力：
	- 日志级别：`INFO` / `WARNING` / `ERROR` / `FATAL`
	- `VLOG(n)` 细粒度调试日志（按 verbose 等级控制）
	- `CHECK` / `DCHECK` 断言（失败可直接终止并打印关键信息）
	- 可配置日志目录、文件滚动、是否同时输出到 stderr 等（具体取决于编译/配置选项）

### 1.3 二者关系（为什么经常一起出现）

- `gflags` 负责“**解析命令行参数**”，`glog` 负责“**输出日志**”。
- `glog` 常常与 `gflags` 联动：
	- 一些项目会用 `gflags` 提供 `--log_dir`、`--v` 等参数，再由 `glog` 按这些参数决定日志行为。
	- 注意：不同发行版/构建方式下，`glog` 是否强依赖 `gflags`、以及支持哪些 flags，可能会有差异。

### 1.4 pjproject

`pjproject`（常见简称 **PJSIP**）是一套成熟的**实时通信（RTC）开源库集合**，核心能力覆盖 SIP 信令与音视频媒体传输。

- 核心用途（在音视频/GB28181 场景里常见）：
    - SIP：注册、呼叫、会话管理、消息收发（可用于实现/对接 SIP 信令）
    - RTP/RTCP：媒体数据传输与控制（音频/视频流的承载与统计）
    - NAT 穿越：STUN/TURN/ICE（取决于启用的组件与配置）
- 组件概念（常见名词对照）：
    - `pjlib`：基础库（线程、网络、内存、工具等）
    - `pjlib-util`：补充工具库
    - `pjnath`：NAT 穿越相关
    - `pjmedia`：媒体处理/传输框架
    - `pjsip`：SIP 协议栈
    - `pjsua(-lib)`：更上层的封装 API（更易用）
- 你通常会在工程里把它用作：SIP 协议栈 / RTP 相关能力的底层依赖。

### 1.5 jrtplib和jthread

`jrtplib` 是一个跨平台的 **RTP/RTCP 库**，用于在网络上传输实时媒体数据（音频/视频）并处理 RTCP 控制信息。

- 核心用途：封装 RTP 包的构造/解析、序列号与时间戳管理、RTCP（SR/RR/SDES/BYE 等）收发与统计。
- 特点：
    - 提供较完整的 RTP/RTCP 数据结构与会话管理能力
    - 适合做“媒体承载层”（把已编码的 H264/H265/AAC 等打包成 RTP 并通过 UDP/TCP 发送）
    - 与具体编解码无强绑定：它管 RTP 协议与会话，不负责编码
- 常见场景：GB28181/RTSP/自研 RTP 推流/收流、需要手动控制 RTP/RTCP 行为的项目。

`jthread` 是 `jrtplib` 作者配套提供的 **跨平台线程/同步工具库**，主要提供线程、互斥锁、事件等基础封装。

- 核心用途：为 `jrtplib`（以及上层应用）提供统一的线程抽象与同步原语，避免大量平台差异代码。
- 常见场景：`jrtplib` 依赖项之一；或在项目里作为轻量线程封装使用。

### 1.6 tinyxml2

`tinyxml2` 是一个轻量级的 **XML 解析库（C++）**，以“易集成、依赖少、体积小”为主要特点。

- 核心用途：读取/解析 XML 配置、生成 XML 文本，提供节点/属性的访问与修改。
- 特点：
    - 单文件/少文件集成，几乎无额外依赖
    - API 简洁，适合做配置与协议消息的 XML 处理
    - 以 UTF-8 为主要输入输出编码（常见用法）
- 常见场景：读取服务配置、解析设备/平台的 XML 描述（如 GB28181 的部分 XML 消息体/配置文件等）。

### 1.7 jsoncpp

`jsoncpp`（JsonCpp）是一个常用的 **JSON 解析与生成库（C++）**。

- 核心用途：把 JSON 文本解析成内存结构（对象/数组/字符串/数字等），或把内存结构序列化为 JSON 字符串。
- 特点：
    - 支持 DOM 风格的 `Json::Value` 数据结构，使用直观
    - 提供 Reader/Writer（或 CharReader/StreamWriter）用于解析与输出
    - 适合做配置、接口返回、调试数据落盘等
- 常见场景：服务端配置文件（JSON 格式）、HTTP/REST 接口消息体、日志/调试输出结构化数据。

### 1.8 libevent

`libevent` 是一个高性能的 **事件通知库**，用于统一管理 I/O 事件、定时器、信号等，并提供事件循环（event loop）。

- 核心用途：在单线程或多线程模型下，用“事件驱动”的方式处理大量 socket 连接与定时任务。
- 典型能力：
    - I/O 复用封装：根据平台自动选择 `epoll` / `kqueue` / `select` 等
    - 定时器、信号处理、缓冲 I/O（bufferevent）、轻量 HTTP（evhttp，视编译选项）
    - 可选线程支持（如 `libevent_pthreads`）
- 常见场景：SIP/信令/媒体服务器的网络收发、TCP/UDP 大量连接管理、需要稳定定时器与事件循环的组件。

## 2. 安装步骤

### 1.1 gflags

- 版本`glog-0.3.5`
- ` ./configure CXXFLAGS="-std=gnu++11" `生成`Makefile`文件
- `make`和`make install`将其安装到`/usr/local/include`和`/usr/local/lib`目录
- 移动`/usr/local/include/gflags`和`/usr/local/lib/libgflags.a`到项目目录`3rd`中
- 注意：该版本不能使用c++17标准进行编译，出现如下报错

        g++ -DHAVE_CONFIG_H -I. -I./src  -I./src       -Wall -Wwrite-strings -Woverloaded-virtual -Wno-sign-compare  -DNO_FRAME_POINTER  -g -O2 -MT src/logging_unittest-logging_unittest.o -MD -MP -MF src/.deps/logging_unittest-logging_unittest.Tpo -c -o src/logging_unittest-logging_unittest.o `test -f 'src/logging_unittest.cc' || echo './'`src/logging_unittest.cc
        In file included from src/logging_unittest.cc:58:
        src/googletest.h:579:33: error: ISO C++17 does not allow dynamic exception specifications
        579 | void* operator new(size_t size) throw(std::bad_alloc) {
            |                                 ^~~~~
        src/googletest.h:586:35: error: ISO C++17 does not allow dynamic exception specifications
        586 | void* operator new[](size_t size) throw(std::bad_alloc) {
            |                                   ^~~~~
        src/logging_unittest.cc: In function ‘void TestDCHECK()’:
        src/logging_unittest.cc:568:3: warning: ‘template<class> class std::auto_ptr’ is deprecated: use 'std::unique_ptr' instead [-Wdeprecated-declarations]
        568 |   auto_ptr<int64> sptr(new int64);
            |   ^~~~~~~~
        In file included from /usr/include/c++/11/bits/locale_conv.h:41,
                        from /usr/include/c++/11/locale:43,
                        from /usr/include/c++/11/iomanip:43,
                        from src/logging_unittest.cc:44:
        /usr/include/c++/11/bits/unique_ptr.h:57:28: note: declared here
        57 |   template<typename> class auto_ptr;
            |                            ^~~~~~~~
        make: *** [Makefile:1275: src/logging_unittest-logging_unittest.o] Error 1

### 1.2 glog

- 版本`gflags-2.2.2`
- `cmake ." `生成`Makefile`文件
- `make`和`make install`将其安装到`/usr/local/include`和`/usr/local/lib`目录
- 移动`/usr/local/include/glog`和`/usr/local/lib/libglog.a`到项目目录`3rd`中

### 1.3 pjproject

- 版本`pjproject-2.7.2`
- `./configure CXXFLAGS="-std=gnu++11"`生成`Makefile`文件
- `make dep`和`make`和`make install`将其安装到`/usr/local/include`和`/usr/local/lib`目录
- 移动`/usr/local/include/*`和`/usr/local/lib/*`到项目目录`3rd`中

- 注意：该版本不能使用c++17标准进行编译,会出现报错
- 注意：链接库时出现`-lpjsdp-x86_64-unknown-linux-gnu`库不存在，原因是该库编译后不在/usr/local/lib目录下，而是在原项目目录中的`pjmedia`中的lib目录下



### 1.4 jrtplib和jthread

- 版本`jrtplib-3.11.2  jthread-1.3.3`
- `cmake .`生成`Makefile`文件
- `make`和`make install`将其安装到`/usr/local/include`和`/usr/local/lib`目录
- 移动`/usr/local/include/jthread`和`/usr/local/lib/libjthread.a`到项目目录`3rd`中

### 1.5 tinyxml2

- 有camke文件
- `make`和`make install`将其安装到`/usr/local/include`和`/usr/local/lib`目录
- 移动`/usr/local/include/tinyxml2.h`和`/usr/local/lib/libtinyxml2.a`到项目目录`3rd`中

### 1.6 jsoncpp

- 版本`jsoncpp-1.8.4`
- `cmake .`生成`Makefile`文件
- `make`和`make install`将其安装到`/usr/local/include`和`/usr/local/lib`目录
- 移动`/usr/local/include/json`和`/usr/local/lib/libjsoncpp.a`到项目目录`3rd`中

### 1.6 libevent

- 版本`libevent-2.1.12-stable`
- `./configure --disable-openssl`生成`Makefile`文件,不需要依赖openssl
- `make`和`make install`将其安装到`/usr/local/include`和`/usr/local/lib`目录
- 移动`/usr/local/include/ev*`和`/usr/local/lib/libevent.a`和`libevent_pthreads.a`到项目目录`3rd`中
